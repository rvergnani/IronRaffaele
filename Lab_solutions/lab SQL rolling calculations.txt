1)

select MONTH(rental_date) AS rental_month, count(distinct customer_id) as active_customers 
from rental
group by rental_month
order by rental_month;


2)

SELECT COUNT(distinct customer_id) FROM rental WHERE rental_date > (MONTH(rental_date) - 1);
SELECT first_name, last_name 
FROM customer
WHERE customer_id IN
(
SELECT customer_id FROM rental WHERE rental_date > (MONTH(rental_date) - 1)
);


3)

create or replace view monthly_active_customers as
select MONTH(rental_date) AS rental_month, count(distinct customer_id) as active_customers 
from rental
group by rental_month
order by rental_month